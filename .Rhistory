na_if(all(ifelse( !all(is.na(x)), max(x, na.rm=T), NA), NA))
}  ## set my own max function to avoid '-INF'
biddy$winningbid <- apply(biddy,1,FUN=my.max)
my.max <- function(x){
all(ifelse( !all(is.na(x)), max(x, na.rm=T), NA))
}  ## set my own max function to avoid '-INF'
biddy$winningbid <- apply(biddy,1,FUN=my.max)
biddy %>% mutate(winningbid = apply(biddy,1,FUN=my.max))
biddy$winningbid <- apply(biddy,1,FUN=my.max))
biddy$winningbid <- apply(biddy,1,FUN=my.max)
my.max <- function(x){
all(ifelse( !all(is.na(x)), max(x, na.rm=T), NA))
}  ## set my own max function to avoid '-INF'
biddy$winningbid <- apply(biddy,1,FUN=my.max)
my.max <- function(x){
ifelse(!all(is.na(x)), max(x, na.rm=T), NA)
}  ## set my own max function to avoid '-INF'
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max))
?mutate_at
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at(.winningbid, .funs = na_if(x,NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at(winningbid, .funs = na_if(x,NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid', .funs = na_if(x,NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid', .funs = na_if(NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid', .funs = na_if('winningbid',NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid', .funs = na_if())
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate(na_if('winningbid','NA'))
?na_if
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid',.funs=na_if(,'NA'))
?mutate_
?mutate_at
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid',.funs=na_if(.vars,'NA'))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid',.funs=na_if(.var,'NA'))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid',.funs=na_if(biddy$winningbid.var,'NA'))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid',.funs=na_if(biddy$winningbid,'NA'))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_at('winningbid',.funs=na_if(winningbid,'NA'))
?na_if
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate(winningbid=na_if(winningbid,'NA'))
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_(winningbid=na_if(winningbid,NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate_all(winningbid=na_if(winningbid,NA))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate(winningbid=na_if(winningbid,NA))
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- orig_data %>% select(biddy_list)
my.max <- function(x){
ifelse(!all(is.na(x)), max(x, na.rm=T), NA)
}  ## set my own max function to avoid '-INF'
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>% mutate(winningbid=na_if(winningbid,NA))
biddy$winningbid
i <- sample(1:length(biddy),1)
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
function (x, size, replace = FALSE, prob = NULL)
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
i=18
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
i <- sample(1:length(biddy),1)
stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max))
biddy
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,'reserve')
glimpse(biddy)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,reserve)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.name_repair = c('reserve','sale'))
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.after = c('reserve','sale'))
orig_data$sell
orig_data$dealer
orig_data$options
buyoptions_vec <- c('inspection','reserve','buyitnow')
desc_data <- orig_data %>% select('dealer',buyoptions_vec) ##group by dealer and private seller
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) ##group by dealer and private seller
glimpse(desc_data)
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
group_by('dealer')##group by dealer and private seller
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
filter(!is.na(dealer)) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
?across
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
filter(!is.na(dealer) & !is.na(buyoptions_vec)) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
?summarise
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
filter(!is.na(dealer)) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"), na.rm = TRUE)
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
filter(!is.na(dealer)) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"), na.rm = TRUE)
?lst
?tibble
?mutate_all
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
mutate_all(vars,.funs=drop_na) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
mutate_all(vars,.funs=na.omit) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
mutate_all(vars,.funs=na.omit) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
mutate_all(vars,.funs=na.rm) %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit()%>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit()%>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(is.factor, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(buyoptions_vec, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(buyoptions_vec, tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(everything(), tibble::lst(mean, sd), .names = "{fn}_{col}"))
orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer') %>% ##group by dealer and private seller
summarise(across(everything(), tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer') %>% ##group by dealer and private seller
table(across(everything(), tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer') %>% ##group by dealer and private seller
table(across(everything(), tibble::lst(mean, sd), .names = "{fn}_{col}"))
desc_data <- orig_data %>% select('dealer',all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer')
desc_data
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by('dealer')
desc_data
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)
desc_data
table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
e
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(table1)
?ftable
?factor
?as.factor
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
factor(dealer, c(0:1, NA), labels = c('seller','dealler','NA'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
factor(dealer, c(0:1, NA), labels = c('seller','dealler','NA'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>% factor(dealer, c(0:1, NA), labels = c('seller','dealler','NA')) ##group by dealer and private seller
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>% factor(dealer, c(0:1, NA), labels = c('seller','dealler','NA')) %>%
group_by(dealer)  ##group by dealer and private seller
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
as.factor(dealer, c(0:1, NA), labels = c('seller','dealler','NA'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
factor(desc_data$dealer, c(0:1, NA), labels = c('seller','dealler','NA'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
factor(desc_data$dealer, c(0:1, NA), labels = c('seller','dealler'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
as.factor(desc_data$dealer, c(0:1, NA), labels = c('seller','dealler'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
factor(dealer, levels = c('seller','dealler'))
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer) %>%  ##group by dealer and private seller
factor('dealer', levels = c('seller','dealler'))
desc_data
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
factor(desc_data$dealer, levels = c('seller','dealler'))
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$dealer, labels = c('inspection','no_inspection'))
desc_data$reserve <- factor(desc_data$dealer, labels = c('have_secret_reserve','no_reserve'))
desc_data$buyitnow <- factor(desc_data$dealer, labels = c('with_buyitnow_option','without_buyitnow_option'))
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(table1)
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$dealer, labels = c('inspection','no_inspection'))
desc_data$reserve <- factor(desc_data$dealer, labels = c('have_secret_reserve','no_reserve'))
desc_data$buyitnow <- factor(desc_data$dealer, labels = c('with_buyitnow_option','without_buyitnow_option'))
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(table1)
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$dealer, labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$dealer, labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$dealer, labels = c('without_buyitnow_option','with_buyitnow_option'))
desc_data$dealer <- factor(desc_data$dealer,level=c(0,1), labels = c('seller','dealler'))
desc_data$dealer <- factor(desc_data$dealer,level=c(0,1), labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$dealer,level=c(0,1), labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$dealer,level=c(0,1), labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$dealer,level=c(0,1), labels = c('without_buyitnow_option','with_buyitnow_option'))
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(table1)
table1 <- prop.table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
table1 <- prop.table(desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
table1 <- table(desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(table1)
table1
table1 <- table(desc_data$dealer,desc_data$inspection)
ftable(table1)
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
table1 <- table(desc_data$dealer,desc_data$inspection)
ftable(table1)
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
desc_data$dealer <- factor(desc_data$dealer,level=c(0,1), labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$dealer,level=c(0,1), labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$dealer,level=c(0,1), labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$dealer,level=c(0,1), labels = c('without_buyitnow_option','with_buyitnow_option'))
table1 <- table(desc_data$dealer,desc_data$inspection)
ftable(table1)
desc_data$dealer <- factor(labels = c('seller','dealler'))
desc_data$inspection <- factor(labels = c('no_inspection','inspection'))
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$dealer,labels = c('no_inspection','inspection'))
table1 <- table(desc_data$dealer,desc_data$inspection)
ftable(table1)
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$inspection,labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$reserve,level=c(0,1), labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$buyitnow,level=c(0,1), labels = c('without_buyitnow_option','with_buyitnow_option'))
table1 <- table(desc_data$dealer,desc_data$inspection)
ftable(table1)
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealler'))
desc_data$inspection <- factor(desc_data$inspection,labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$reserve,level=c(0,1), labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$buyitnow,level=c(0,1), labels = c('without_buyitnow_option','with_buyitnow_option'))
table1 <- table(desc_data$dealer,desc_data$inspection)
ftable(table1)
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(table1)
prop.table(table1)
table1 <- round(prop.table(table1))
ftable(table1)
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(round(prop.table(table1), 3))
table1 <- table(desc_data$dealer,c(desc_data$inspection,desc_data$reserve,desc_data$buyitnow))
table1 <- table(desc_data$dealer,desc_data$inspection,desc_data$reserve,desc_data$buyitnow)
ftable(round(prop.table(table1), 3))
ftable(round(prop.table(table1), 1))
ftable(round(prop.table(table1), 4))
?ftable
ftable(dexc_data, row.vars = c('inspection','reserve'),col.vars=c('dealer'))
ftable(table1, row.vars = c('inspection','reserve'),col.vars=c('dealer'))
ftable(desc_data[c('dealer','inspection')])
ftable(desc_data[c('dealer','inspection','reserve')])
ftable(desc_data[c('inspection','reserve','dealer')])
ftable(desc_data[c('reserve','dealer')])
prop.table(desc_data[c('reserve','dealer')])
ftable(desc_data[c('reserve','dealer')])
ftable(desc_data[c('reserve','dealer')])
table1 <- ftable(desc_data[c('reserve','dealer')])
table2 <- ftable(desc_data[c('inspection','dealer')])
rbind.data.frame(table1,table2)
rbind(table1,table2)
table1 <- ftable(desc_data[c('reserve','dealer')])
table1
as.data.frame(table1)
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealer'))
desc_data$inspection <- factor(desc_data$inspection,labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$reserve,level=c(0,1), labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$buyitnow,level=c(0,1), labels = c('without_buyitnow_option','with_buyitnow_option'))
table1 <- ftable(desc_data[c('reserve','dealer')])
table2 <- ftable(desc_data[c('inspection','dealer')])
as.data.frame(table1)
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
desc_data$dealer <- factor(desc_data$dealer, labels = c('seller','dealer'))
desc_data$inspection <- factor(desc_data$inspection,labels = c('no_inspection','inspection'))
desc_data$reserve <- factor(desc_data$reserve,level=c(0,1), labels = c('no_reserve','have_secret_reserve'))
desc_data$buyitnow <- factor(desc_data$buyitnow,level=c(0,1), labels = c('without_buyitnow_option','with_buyitnow_option'))
table1 <- ftable(desc_data[c('reserve','dealer')])
table2 <- ftable(desc_data[c('inspection','dealer')])
as.data.frame(table1)
table1
data.frame(table1)
prop.table(table1)
table <- prop.table(table1)
table1 <- prop.table(table1)
table1 <- data.frame(prop.table(table1))
table1
table1 <- prop.table(table1)
table1 <- ftable(desc_data[c('reserve','dealer')])
table1 <- prop.table(table1)
table1
table1 <- round(prop.table(table1),4)
table1
table1 <- table(desc_data[c('reserve','dealer')])
table1 <- round(prop.table(table1),4)
table1
table2 <- table(desc_data[c('inspection','dealer')])
merge(table1,table2)
data.table(table1)
data.table(table1,table2)
table1 <- table(desc_data[c('reserve','dealer')])
table2 <- table(desc_data[c('inspection','dealer')])
merge(table1,table2)
rbind(table1,table2)
table3 <- table(desc_data[c('buyitnow','dealer')])
rbind(table1,table2,table3)
# Get Descriptive Tables
for (i in 1:3){
table[i] <- table(desc_data[c(buyoptions_vec[i],'dealer')])
}
table=table()
# Get Descriptive Tables
table <- NULL
for (i in 1:3){
table_i <- table(desc_data[c(buyoptions_vec[i],'dealer')])
table_i <- round(prop.table(table_i),4)
table <- rbind(table,table_i)
}
table
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)  ##group by dealer and private seller
# Set labels
desc_data$dealer <- factor(desc_data$dealer, labels = c('Seller','Dealer'))
desc_data$inspection <- factor(desc_data$inspection,labels = c('Without Inspection','With Inspection'))
desc_data$reserve <- factor(desc_data$reserve,level=c(0,1), labels = c('No Reserve Prive','With Secret Reserve'))
desc_data$buyitnow <- factor(desc_data$buyitnow,level=c(0,1), labels = c('No BUYITNOW Option','With BUYITNOW Option'))
# Get Descriptive Tables
table <- NULL
for (i in 1:3){
table_i <- table(desc_data[c(buyoptions_vec[i],'dealer')])
table_i <- round(prop.table(table_i),4)
table <- rbind(table,table_i)
}
table
desc_data <- orig_data %>% select(dealer,all_of(buyoptions_vec)) %>%
na.omit() %>%
group_by(dealer)
desc_data
data.frame(table)
#-------------------------
# Part 2
biddy_list <- sprintf("biddy%d",1:22)  ## vector with formatted combination of text and variable values
biddy_list
my.max <- function(x){
ifelse(!all(is.na(x)), max(x, na.rm=T), NA)
}  ## set my own max function to avoid '-INF'
biddy <- orig_data %>% select(biddy_list)
biddy <- biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>%
mutate(winningbid=na_if(winningbid,NA))
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
biddy <- orig_data %>% select(biddy_list)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy %>% add_column(orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(.data=orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
biddy
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(.data=orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
biddy <- orig_data %>% select(biddy_list)
biddy <- biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>%
mutate(winningbid=na_if(winningbid,NA))
glimpse(biddy)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- orig_data %>% add_column(.data=biddy,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
?add_column
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(.data=orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
biddy <- orig_data %>% select(biddy_list)
biddy <- biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>%
mutate(winningbid=na_if(winningbid,NA))
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
glimpse(biddy)
##Testing:
##biddy$winningbid
##i <- sample(1:length(biddy),1)
##stopifnot(biddy$winningbid[i]==my.max(biddy[i,-23]))
biddy <- biddy %>% add_column(orig_data,.after = c('reserve','numbids','startbid','totallisted','totalsold'))
biddy <- select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy)
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy)
biddy
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy,.after='winningbid')
biddy <- orig_data %>% select(biddy_list)
biddy <- biddy %>% mutate(winningbid=apply(biddy,1,FUN=my.max)) %>%
mutate(winningbid=na_if(winningbid,NA))
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy,.after='winningbid')
biddy
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy,.after=c('winningbid'))
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy,.after=1)
biddy
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy,.after)
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>% add_column(biddy['winningbid'])
biddy
biddy <- orig_data %>% select('reserve','numbids','startbid','totallisted','totalsold') %>%
add_column(biddy['winningbid']) %>%
mutate(margin=winningbid-reserve)
biddy
orig_data$bookvalue
biddy <- orig_data %>% select('dealer','reserve','bookvalue','numbids','startbid','totallisted','totalsold') %>%
add_column(biddy['winningbid']) %>%
mutate(margin=winningbid-bookvalue)
biddy
install.packages("stargazer")
library(stargazer)
## I found a great amount of obs have negative margin <- (winningbid - bookvalue)
stargazer(biddy)
stargazer(table)
